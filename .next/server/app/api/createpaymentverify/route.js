"use strict";(()=>{var e={};e.id=6082,e.ids=[6082],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6005:e=>{e.exports=require("node:crypto")},85136:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var a={};r.r(a),r.d(a,{POST:()=>u});var s=r(73278),i=r(45002),n=r(54877),o=r(82208),p=r(71309);async function u(e){try{let t=await e.json(),{createHmac:a}=await Promise.resolve().then(r.t.bind(r,6005,23)),s=a("sha256","123456");s.update(JSON.stringify(t));let i=s.digest("hex"),n=e.headers.get("x-razorpay-Signature");if(console.log("signature->",n),n!==i)return p.NextResponse.json({msg:"Invalid signature"},{status:401});if("subscription.charged"===t.event){let e=t.payload.subscription.entity.id,r=t.payload.subscription.entity.notes.clerkid;if(await o.L.user.update({where:{clerkid:r},data:{subscription:{update:{data:{customerId:e,plan:"PRO"}}}}}))return p.NextResponse.json({status:200})}return p.NextResponse.json({status:404})}catch(e){return console.log("error.message->",e),p.NextResponse.json({status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/createpaymentverify/route",pathname:"/api/createpaymentverify",filename:"route",bundlePath:"app/api/createpaymentverify/route"},resolvedPagePath:"C:\\Users\\Prajval Bhardwaj\\Desktop\\opal_codes\\video\\src\\app\\api\\createpaymentverify\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:m}=d,y="/api/createpaymentverify/route";function v(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}},73278:(e,t,r)=>{e.exports=r(30517)},82208:(e,t,r)=>{r.d(t,{L:()=>s});var a=r(53524);let s=globalThis.prisma||new a.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9379,1309],()=>r(85136));module.exports=a})();